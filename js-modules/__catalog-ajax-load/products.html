<script>
//Подрузка товаров ajax'ом
var loadAjaxContent = {

    xhr: new XMLHttpRequest(),

    ITEMS_PER_CLICK: 6,

    fragmentsContainer: document.createDocumentFragment(),

    ajaxObject: null,

    listenClick: (jsonFrom, container) => {
        document.querySelector(".js-ajax-btn").addEventListener("click", function (event) {
            if (loadAjaxContent.xhr.status === 200) {
                loadAjaxContent._addContentAfterClick(container);
                return false;
            }
            loadAjaxContent.xhr.addEventListener('load', function () {
                loadAjaxContent.ajaxObject = JSON.parse(loadAjaxContent.xhr.responseText);
                event.preventDefault();
                loadAjaxContent._addContentAfterClick(container);
              });
            loadAjaxContent.xhr.open("GET", jsonFrom);
            loadAjaxContent.xhr.send();
        });
    },

    _addContentAfterClick: (containerToInsert) => {
        for (var i = 0; i < loadAjaxContent.ITEMS_PER_CLICK; i++) {
            if (loadAjaxContent.ajaxObject.length <= 0) {
                document.querySelector(".js-ajax-btn").classList.add("visually-hidden");
                continue;
            }
            var fragItem = document.createRange().createContextualFragment(loadAjaxContent.ajaxObject[0]);
            loadAjaxContent.fragmentsContainer.appendChild(fragItem);
            loadAjaxContent.ajaxObject.shift();
        };
        document.getElementById("products-list-container").appendChild(loadAjaxContent.fragmentsContainer);
        if (loadAjaxContent.ajaxObject.length <= 0) {
            document.querySelector(".js-ajax-btn").classList.add("visually-hidden");
        }
    },

    init: () => {
        loadAjaxContent.listenClick("json/ajax-catalog.json", "products-list-container");
    },
};
loadAjaxContent.init();
</script>