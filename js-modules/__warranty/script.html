<script>
//СЛАЙДЕР ПОСЛЕДНИХ ПРОСМОТРЕННЫХ ТОВАРОВ
var watchedProducts = new Glide('.js-catalog-slider__container', {
    gap: -1,
    bound: true,
    rewind: false,
    perView: 4,
    peek: {
        before: 0,
        after: 0,
    },
    breakpoints: {
        1023: {
            peek: {
                before: 0,
                after: 50,
            },
            perView: 3,
        },
        767: {
            peek: {
                before: 0,
                after: 50,
            },
            perView: 2,
        },
        575: {
            peek: {
                before: 0,
                after: 100,
            },
            perView: 1,
        },
        480: {
            peek: {
                before: 0,
                after: 30,
            },
            perView: 1,
        },
    }
});
watchedProducts.mount();
//стики навигация - обработчик клика кнопок
var anchorTransition = {
    listenBtnClick: () => {
        document.querySelectorAll(".js-sticky-btn").forEach(function(item) {
            item.addEventListener("click", (event) => {
                anchorTransition._removeAllBtnsActive();
                anchorTransition._addActiveForBtns(item);
            });
        });
    },

    _removeAllBtnsActive: () => {
        document.querySelectorAll(".js-sticky-btn").forEach((item) => {
            item.classList.remove("active-btn");
        });
    },

    _addActiveForBtns: (clickedBtn) => {
        clickedBtn.classList.add("active-btn");
    },
};
anchorTransition.listenBtnClick();
//плавное раскрытие схлопнутых элементов
var expandCollapsedItems = {

    TRANSITION_TIME: "300",

    showCollapsedElement: () => {
        document.querySelectorAll(".js-call-collapsed-element").forEach(function(item) {
            item.addEventListener("click", (event) => {
                if (item.classList.contains("active-btn")) {
                    expandCollapsedItems._removeBtnActive(item);
                    var currentCollapsedElement = expandCollapsedItems._findClickedBtnsDataToId(item);
                    expandCollapsedItems._getTrueElementHeight(currentCollapsedElement);
                    expandCollapsedItems._deleteInlineStyleFromCollapsed(currentCollapsedElement);
                    return false;
                }
                expandCollapsedItems._addBtnActive(item);
                var currentCollapsedElement = expandCollapsedItems._findClickedBtnsDataToId(item);
                expandCollapsedItems._getTrueElementHeight(currentCollapsedElement);
                expandCollapsedItems._deleteMaxHeightFromExpanded(currentCollapsedElement);
            });
        });
    },

    _addBtnActive: (clickedBtn) => {
        clickedBtn.classList.add("active-btn");
    },

    _removeBtnActive: (clickedBtn) => {
        clickedBtn.classList.remove("active-btn");
    },

    _deleteMaxHeightFromExpanded: (item) => {
        setTimeout(function() {
            item.style.maxHeight = "none";
        }, expandCollapsedItems.TRANSITION_TIME);
    },

    _deleteInlineStyleFromCollapsed: (item) => {
        setTimeout(function() {
            item.style.removeProperty("max-height");
        }, 1);
    },

    _findClickedBtnsDataToId: (clickedBtn) => {
        return document.getElementById(clickedBtn.dataset.findId);
    },

    _getTrueElementHeight: (collapsedElement) => {
        collapsedElement.style.maxHeight = collapsedElement.scrollHeight + "px";
    },
};
expandCollapsedItems.showCollapsedElement();
</script>