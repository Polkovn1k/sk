<script>
    //описываем новый объект
    function CustomValidation() {}
    CustomValidation.prototype = {
      // Установим пустой массив сообщений об ошибках
      invalidities: [],

      // Метод, проверяющий валидность (в качестве аргумента выбранный input)
      checkValidity: function(input) {
        var validity = input.validity;
        var email = input.classList.contains("reg-email");

        //ошибка если поле пустое
        if (!input.value) {
          this._addInvalidity("Поле не заполнено");
        }

        //ошибка если сиволов больше лимита
        if (validity.tooLong) {
          var maxlength = input.getAttributeValue("maxlength");
          this._addInvalidity("Введено более " + maxlength + " символов");
        }

        //ошибка если сиволов меньше лимита
        var minlength = input.getAttribute("minlength");
        if (input.value.length < minlength) {
          this._addInvalidity("Введено менее " + minlength + " символов");
        }

        //ошибка если поле email не соответствует параметрам regExp
        var emailRegExp = /^[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/;
        if (emailRegExp.test(input.value) == false) {
          this._addInvalidity("Введите корректный email");
        }
      },

      // Добавляем сообщение об ошибке в массив ошибок
      _addInvalidity: function(message) {
        this.invalidities.push(message);
      },

      // Убираем все сообщения об ошибке из массива ошибок
      _removeInvalidity: function() {
        this.invalidities.splice(0);
      },

      // Получаем общий текст сообщений об ошибках
      _getInvalidities: function() {
        return this.invalidities.join('. \n');
      },

      //Вставляем текст сообщения об ошибке
      _getSiblingElementOfInput: (input, message) => {
          var inputSibling = input.nextElementSibling;
          inputSibling.innerText = message;
      },

      //Вставляем текст сообщения об ошибке
      _addInvalidClassForInput: (input) => {
          input.classList.add("invalid");
      },

      _removeInvalidClassForInput: (input) => {
          if (input.classList.contains("invalid")) {
              input.classList.remove("invalid");
          }
      },

      _addValidClassForInput: (input) => {
          if (input.classList.contains("invalid")) {
              return false;
          }
          input.classList.add("valid");
      },

      _removeValidClassForInput: (input) => {
          if (input.classList.contains("valid")) {
              input.classList.remove("valid");
          }
      },
    };

    (function () {
        var regSubmit = document.querySelector(".js-submit-pass-recovery");
        regSubmit.addEventListener("mousedown", function(event) {
            var inputs = document.querySelectorAll(".js-pass-recovery");
            for (var i = 0; i < inputs.length; i++) {
                var currentInput = inputs[i];
                var inputCustomValidation = new CustomValidation();
                inputCustomValidation.checkValidity(currentInput);
                var customValidityMessage = inputCustomValidation._getInvalidities();
                currentInput.setCustomValidity(customValidityMessage);
                inputCustomValidation._removeInvalidity();
            }
        });

        regSubmit.addEventListener("click", function(event) {
            var inputs = document.querySelectorAll(".js-pass-recovery");
            for (var i = 0; i < inputs.length; i++) {
                var currentInput = inputs[i];
                var inputCustomValidation = new CustomValidation();//--------------------------------------создаем новый объект со всеми свойствами для текущего input'a
                inputCustomValidation._removeValidClassForInput(currentInput);//---------------------------удаляем класс Valid
                inputCustomValidation._removeInvalidClassForInput(currentInput);//-------------------------удаляем класс Invalid
                if (currentInput.checkValidity() == false) {//---------------------------------------------делаем проверку на валидность Input'а
                    inputCustomValidation.checkValidity(currentInput);//-----------------------------------проверяем на валидность текущий input
                    var customValidityMessage = inputCustomValidation._getInvalidities();//----------------формируем список всех сообщений по текущему input'у
                    currentInput.setCustomValidity(customValidityMessage);//-------------------------------в свойство validationMessage у input' ложим список сообщений
                    inputCustomValidation._getSiblingElementOfInput(currentInput, customValidityMessage);//в span текущего input'a вставляем список сообщений
                    inputCustomValidation._removeInvalidity();//-------------------------------------------очищаем список всех сообщений
                    inputCustomValidation._addInvalidClassForInput(currentInput);
                    var stopSubmit = true;
                }
                inputCustomValidation._addValidClassForInput(currentInput);
            }

            if (stopSubmit) {
              event.preventDefault();
            }
        });
    }());
</script>